# For recipe
레시피 공유 사이트 입니다!

</br>

# 폴더 구조

```
3-backend-Alvin-recipe
├─ .git
└─ myapp
   ├─ .eslintrc.json 
   ├─ .gitignore
   ├─ .prettierrc.json
   ├─ .vscode
   │  └─ settings.json
   ├─ app.js  // 서버 메인 실행
   ├─ config
   │  ├─ key.js // 배포모드, 개발모드 구분
   │  └─ production.js
   ├─ controllers
   │  ├─ comments.js // 댓글 컨트롤러
   │  ├─ posts.js // 게시글 컨트롤러
   │  └─ users.js // 유저 컨트롤러
   ├─ email.js
   ├─ models
   │  ├─ comment.js // 댓글 데이터베이스 접근 코드
   │  ├─ database.js // 데이터베이스 접속 코드
   │  ├─ posts.js // 게시글 데이터베이스 접근 코드
   │  ├─ upload.js // 이미지 업로드
   │  └─ users.js // 유저 데이터베이스 접근 코드
   ├─ package-lock.json
   ├─ package.json
   └─ routes
      ├─ comments.js // 댓글 라우터
      ├─ index.js // 기본 라우터
      ├─ posts.js // 게시글 라우터
      └─ users.js // 유저 라우터

```

# 주요 기능

+ Users
    + 회원가입
    + 회원정보 수정
    + 로그인
    + 로그아웃
    + 프로필 이미지 변경
    + 아이디 찾기
    + 임시 비밀번호 발급
    + 이메일 인증
    + 회원탈퇴  
</br>

+ Posts
    + 게시글 쓰기
    + 게시글 검색
    + 게시글 상세보기
    + 게시글 삭제
    + 게시글 수정
    + 게시글 좋아요
    + 내가 쓴 게시글 조회  
</br>

+ Comments
    + 댓글 등록
    + 댓글 조회
    + 댓글 수정
    + 댓글 삭제
    + 댓글 좋아요
    + 내가 쓴 댓글 조회  

</br>

# 프로젝트 설계도

![프로젝트 구성도](https://user-images.githubusercontent.com/97275939/167240482-21952e70-37cc-4dd5-a263-cb1aa31570e5.PNG)

</br>

# 문제점과 해결 방법

+ 이미지 여러장 데이터베이스에 저장

데이터베이스 post 테이블에 images 컬럼에 여러개의 이미지를 insert해야 했었다.   
사용자가 게시글을 작성할 때 업로드 시키는 이미지를 image 테이블에 저장을 하고, 저장된 indexID를 post 테이블에 insert 해야했었는데 단순히 indexID가 1,2,3 이라면 배열에 '1,2,3' 푸쉬하고 데이터베이스에 저장시키면 MYSQL 에서 , 를 인식해서 MYSQL 문법 에러가 났다. (Error 1064)  

해결을 해놓고 보니 해결방법은 생각보다 간단했는데, 데이터를 insert할때 데이터 형식을  
JSON방식으로 insert를 해서 배열을 넣을 수 있었고 MYSQL 문법 에러도 나지 않았다.

+ 배포 후 메일발송 불가능




</br>

# 프로젝트 시연 영상

</br>

# 추후에 코드 개선할 점들

+ 프론트엔드에서 오는 요청에 대한 응답값을 json message로 통일 

+ 게시글을 등록했을 때 보여지는 썸네일이 있어야 하는데 이 부분을 게시글 등록할 때 업로드 했던 이미지 중에 제일 마지막에 등록한 이미지를 썸네일로 사용중인데, 이 부분은 추후에 사용자가 썸네일에 사용 될 이미지를 선택할 수 있도록 변경 예정  

+ 이미지 업로드를 받았을 때, 이미지는 서버에 저장하고 이미지 경로(파일이름)는 데이터베이스에 바로 저장을 하는데, 사용자가 업로드 했다가 삭제할 경우에도 서버에는 이미지가 남아있고, 데이터베이스에는 해당 이미지의 경로(파일이름)이 남아있기 때문에, 등록 버튼을 눌렀을 때에만 서버와 데이터베이스에 저장이 되게 변경

</br>

# 회고 다이어리

백엔드 개발을 시작할 때 프론트엔드에서의 동작을 어느정도 알고 있었다면 API를 만들 때 좀 더 수월하게 만들었을 것 같다. postman으로 테스트를 하다보니 postman에서 동작할 수 있게 코드를 작성했고, 그 결과 프론트와 연동할 때 백엔드 코드 수정을 엄청 많이 해야했다.  
그래도 이번에 백엔드,프론트엔드 두 부분을 모두 해보면서 다음에는 좀 더 나은코드를 작성할 수 있을거 같다.  
실제로 백엔드만 진행 후에 프론트를 진행하면서 백엔드코드를 리팩토링을 하게 됐는데,  
그전에는 model, route 분리없이 controller에서 모든 걸 동작하게 했었다.  
때문에 재사용 할 수 있는 코드는 없었고, 기능마다 데이터베이스에 접근하는 코드를 새로 짜야 했었는데, 리팩토링 과정에서 model 분리, route 분리를 하고나니 route에서 무슨 API가 있는지 확인 할 수 있고, controller에서 model 코드를 재사용 할 수 있게 되었다. 

아쉬운 점은 변수명을 직관적이게 선언을 했다고 생각했는데, 한참 후에 보면 변수명만 보고서는 이해가 어려운 부분이 있다. 이부분은 계속해서 고쳐 나가야 할 것 같다. 변수명이 이해가 안되니 다른 코드들도 이해하는데 시간이 조금 걸렸었다. 내가 짠 코드를 내가 이해를 못하다니... 변수명 선언과 주석 다는걸 계속해서 습관화 해야겠다!



</br>

# 느낀점

개발자는 협업 및 소통이 중요하다는 말을 정말 많이 들었는데, 왜 그런지 알 것 같다. 백엔드에서 프론트엔드로 보내주는 메세지에서 한글자만 잘못 알려줘도 오류가 날거고, 그 오류를 잡기위해서 또 다시 모든 코드를 들여다 봐야하는데, 처음부터 소통을 정확하게하고 지속적으로 소통을 하게된다면 이런일을 최소화 할 수 있을거란 생각이 들었다.  

처음 코드를 작성할때 뭐부터 시작해야 할지 몰랐다. 결국 도움을 요청하게 되었고, 내가 코드로 작성하고 싶은 걸 글로 써보라고 하셨다. 글로 쓰는건 어렵지 않았다. 다시 글을 코드로 바꿔보라고 하시면서 '코드는 글을쓰는 행위' 라고 말해주셨고 이 말이 정말 도움이 많이 되었다.  
코드를 작성하다가 막히면 지금 내가 뭘 하려고 하는지 메모장을 켜서 메모장에 적어보게 됐고, 적어 놓은걸 보면서 어느 부분부터 시작을 해야하는지 감을 잡을 수 있었다.  
한마디로 시작하는 방법을 배웠다. 코드를 작성하면서 많은 생각이 드는게 '내가 지금 쓰고있는 이 코드가 맞는코드인가?' 라는 생각을 정말 많이해서 이 부분에 대해서도 질문을 했었는데 '개발에는 정답이없다' 라고 말해주셨던 것도 생각이 난다. 이 두가지를 항상 생각하면서 개발을 했고, 덕분에 처음해보는 프로젝트에서 생각했던 모든 기능을 구현할 수 있었다.
